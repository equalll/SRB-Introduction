# 十分钟了解 SRB
## 1. 什么是SRB
简单(Simple) · 机器人(Rbobtic) · 总线(Bus)</br>

SRB是一种，用一根4Pin总线将机器人的大部分节点连接到主机的总线规范。
SRB抛弃了其他总线协议中复杂的控制方法，只保留了一种控制方法，一种配置方法，极大的降低了学习和开发成本；SRB使用IDC端子，极大的方便了机器人设计中的接线工作。PC，树莓派，Arduino都可以成为主机，这些设备可以使用USB或者UART连入总线。SRB总线工作在1Mb/s，期望系统频率可以达到1kHz，达到了大部分控制系统中实时控制的要求。

## 2. SRB的结构
SRB是一条总线，总线上有一个主机和多个节点，每个节点带有一个或多个设备，设备可以是控制器或者传感器。</br>
![](http://assets.processon.com/chart_image/5bda4437e4b0e4521333bf03.png?_=1554115174493)</br>
这里提到的控制器是指接受指令进行动作的器件，例如电机、蜂鸣器。</br>
传感器指读取物理状态转换为电信号的设备，例如电机测速器，倾角传感器。</br>

#### 让我们看看实物的情况
SRB的实际接线也非常简单，如下图：主机和一个节点使用灰色排线和IDC端子连接，总线需要添加设备时，只需要在排线中</br>
![SRB总线实际接线](http://assets.processon.com/chart_image/5ca20399e4b071e8c5412f5a.png?_=1554122135171)</br>
主机和一个节点使用灰色排线和IDC端子连接，总线需要添加设备时，只需要在原来的排线上再压入一个IDC接口。</br>
## 3. 通信模型
在节点上有一个数据结构体，节点会根据数据结构体对设备进行控制，或者采集数据，存入数据结构体。
![](http://assets.processon.com/chart_image/5ca20648e4b034408de9324c.png?_=1554123686105)
主机可以建立一个节点的模型，里面有一个和节点结构相同的数据仓库，主机可以通过访问将自己的数据发往远端，或者读取远端的数据存入节点。





_到此为止你已经可以使用SRB了。为了用的更好，还是建议你继续读这个文档。
_
## 4. 访问控制-映射
上一节我们描述了访问的过程，那么一次访问究竟让那些节点进行了上传，哪些节点进行了下载呢？
映射会对此进行控制。每个节点同时可以保存4种映射。映射是由节点决定的，主机不能任意修改映射内容，
必须提供节点的映射信息，节点才能工作。有些节点的映射是可以动态修改的。

## 5. 配置信息-簇
簇被用来配置节点，配置簇配置的内容掉电不会消失，通常需要在配置后重启节点才能生效。
另外配置簇必须整体写入，或者整体读出。有些节点会将运行信息储存入簇。比如讲模拟-数字采样的修正系数存入簇。

## 关键词
- **主机(Master)** SRB的主机，控制整个总线的其他节点的硬件。PC，树莓派，Arduino都可以成为主机，这些设备可以使用USB或者UART连入总线。
- **节点(Node)** 被控制的SRB硬件，节点通过总线接收主机的指令并返回数据。每个节点包含一个地址，可以连接多个设备。
- **地址(Address)** SRB设备在总线上的唯一标识，同一个总线上的多个节点的地址必须不同，主机没有地址。
- **设备(Device)** 设备连接在SRB节点上。控制器或者传感器。控制器是指接受指令进行动作的器件；传感器指读取物理状态转换为电信号的设备。
- **数据(Data)** 保存节点当前的状态的数据结构，节点中有一组数据，主机会建立每个节点的数据的克隆，并使用Access进行同步。
- **访问(Access)** 主机与节点进行一次通信的过程，主机将数据的一部分发给节点，节点将另一部分发回主机，同时可能有一部分不被修改。
- **映射(Mapping)** 决定一次访问中，哪些数据被传出，哪些数据被传入的数组。映射由节点决定。
- **簇(Cluster)** 节点中保存配置信息或不经常更新的参数的数据结构。主机可以对其进行读写。
